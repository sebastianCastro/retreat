import{r as e,R as t}from"./vendor-DAvjMybB.js";function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n.apply(this,arguments)}const o=(e,t)=>{const n={};for(const o in e)-1===t.indexOf(o)&&(n[o]=e[o]);return n},s=t.createContext(null),r=t.createContext(null),i=()=>{},a=["onLoad","onError","modules","apiLoader"];function c(r,c=!1,p=[]){return u=>{const{width:l,height:d,modules:h=[],onLoad:m=i}=u,f=((t=[])=>{const[n,o]=e.useState(!1),r=e.useRef(t),i=(()=>{const t=e.useContext(s);if(null===t)throw new Error("Couldn't find Yandex.Maps API in the context. Make sure that hook useYMaps is inside <YMaps /> provider");return t})(),a=i.getApi();return e.useEffect(()=>{i.load().then(()=>Promise.all(r.current.map(i.loadModule))).then(()=>o(!0))},[]),n&&a?a:null})(p.concat(h)),y=!c||!!f,v=o(u,a);return e.useEffect(()=>f?m(f):void 0,[f]),y?t.createElement(r,n({ymaps:f},v)):t.createElement("div",{style:{width:l,height:d}})}}const p="undefined"!=typeof window,u={lang:"ru_RU",load:"",ns:"",mode:"release"},l=n=>{const{version:o="2.1",enterprise:r=!1,query:i={lang:"ru_RU",load:"",ns:""},preload:a=!1,children:c}=n,l=e.useRef((e=>{const{query:t=u}=e,n=Date.now().toString(32),o=t.ns||"",s="__yandex-maps-api-onload__$$"+n,r="__yandex-maps-api-onerror__$$"+n,i=p?window:{},a={};let c;const l=()=>o?i[o]:c,d=()=>{delete i[s],delete i[r]};return{load:()=>{if(l())return Promise.resolve(c);if(a[o])return a[o];const n={onload:s,onerror:r,...u,...t},p=Object.keys(n).map(e=>`${e}=${n[e]}`).join("&"),h=[`https://${e.enterprise?"enterprise.":""}api-maps.yandex.ru`,e.version,"?"+p].join("/");return a[o]=new Promise((e,t)=>{var n;i[s]=t=>{d(),t.ready(()=>{c=t,e(t)})},i[r]=e=>{d(),t(e)},(n=h,new Promise((e,t)=>{const o=document.createElement("script");o.type="text/javascript",o.onload=e,o.onerror=t,o.src=n,o.async=!0,document.head.appendChild(o)})).catch(i[r])}),a[o]},getApi:l,loadModule:e=>new Promise((t,n)=>{c.modules.require(e).done(n=>{n.forEach(t=>{((e,t,n,o=!1)=>{const s="string"==typeof t?t.split("."):t.slice();let r,i=e;for(;s.length>1;)r=s.shift(),i[r]||(i[r]={}),i=i[r];const a=s[0];i[a]=!0===o&&i[a]||n})(c,e,t,!0)}),t(c)},n)})}})({version:o,enterprise:r,query:i,preload:a}));return e.useEffect(()=>{a&&l.current.load()},[l.current]),t.createElement(s.Provider,{value:l.current},c)},d=/^on(?=[A-Z])/;function h(e){return Object.keys(e).reduce((t,n)=>{if(d.test(n)){const o=n.replace(d,"").toLowerCase();t._events[o]=e[n]}else t[n]=e[n];return t},{_events:{}})}function m(e,t,n){"function"==typeof n&&e.events.add(t,n)}function f(e,t,n){"function"==typeof n&&e.events.remove(t,n)}function y(e,t,n){Object.keys(Object.assign({},t,n)).forEach(o=>{t[o]!==n[o]&&(f(e,o,t[o]),m(e,o,n[o]))})}const v=e=>"default"+e.charAt(0).toUpperCase()+e.slice(1);function b(e,t){return void 0!==e[t]||void 0===e[v(t)]}function j(e,t,n){return(b(e,t)?e[t]:e[v(t)])||n}function O(e,t,n=null){if(e!==t){if(e&&("current"in e?e.current=null:"function"==typeof e&&e(null)),!t)return;"current"in t?t.current=n:"function"==typeof t&&t(n)}}function g(e){const{width:t,height:n,style:o,className:s}=e;return void 0!==o||void 0!==s?Object.assign({},o&&{style:o},s&&{className:s}):{style:{width:t,height:n}}}class _ extends t.Component{constructor(e){super(e),this.state={error:null,errorInfo:null}}componentDidCatch(e,t){const{onError:n=()=>{}}=this.props;n(e),this.setState({error:e,errorInfo:t})}render(){return this.state.error?null:this.props.children}}const E=e=>({onError:n,...o})=>t.createElement(_,{onError:n},t.createElement(e,o));class w extends t.Component{constructor(){super(),this.instance=null,this.state={instance:null},this._parentElement=null,this._getRef=e=>{this._parentElement=e}}componentDidMount(){this.instance=w.mountObject(this._parentElement,this.props.ymaps.Map,this.props),this.setState({instance:this.instance})}componentDidUpdate(e){null!==this.instance&&w.updateObject(this.instance,e,this.props)}componentWillUnmount(){w.unmountObject(this.instance,this.props)}render(){const e=g(this.props),s=h(this.props),i=o(s,["_events","state","defaultState","options","defaultOptions","instanceRef","ymaps","children","width","height","style","className"]);return t.createElement(r.Provider,{value:this.state.instance},t.createElement("div",n({ref:this._getRef},e,i),this.props.children))}static mountObject(e,t,n){const{instanceRef:o,_events:s}=h(n),r=new t(e,j(n,"state"),j(n,"options"));return Object.keys(s).forEach(e=>m(r,e,s[e])),O(null,o,r),r}static updateObject(e,t,n){const{_events:o,instanceRef:s}=h(n),{_events:r,instanceRef:i}=h(t);if(b(n,"state")){const o=j(t,"state",{}),s=j(n,"state",{});o.type!==s.type&&e.setType(s.type),o.behaviors!==s.behaviors&&(o.behaviors&&e.behaviors.disable(o.behaviors),s.behaviors&&e.behaviors.enable(s.behaviors)),s.zoom&&o.zoom!==s.zoom&&e.setZoom(s.zoom),s.center&&o.center!==s.center&&e.setCenter(s.center),s.bounds&&o.bounds!==s.bounds&&e.setBounds(s.bounds)}if(b(n,"options")){const o=j(t,"options"),s=j(n,"options",{});o!==s&&e.options.set(s)}j(t,"width")===j(n,"width")&&j(t,"height")===j(n,"height")||e.container.fitToViewport(),y(e,r,o),O(i,s,e)}static unmountObject(e,t){const{instanceRef:n,_events:o}=h(t);null!==e&&(Object.keys(o).forEach(t=>f(e,t,o[t])),e.destroy(),O(n))}}const R=E(c(w,!0,["Map"]));R.defaultProps={width:320,height:240};class C extends t.Component{constructor(){super(),this.state={instance:null},this._parentElement=null,this._getRef=e=>{this._parentElement=e}}componentDidMount(){this._mounted=!0,this.props.ymaps.panorama.isSupported()&&C.mountObject(this._parentElement,this.props.ymaps.panorama,this.props).then(e=>this._mounted&&this.setState({instance:e}))}componentDidUpdate(e){null!==this.state.instance&&C.updateObject(this.state.instance,e,this.props)}componentWillUnmount(){this._mounted=!1,C.unmountObject(this.state.instance,this.props)}render(){const e=g(this.props);return t.createElement("div",n({ref:this._getRef},e))}static mountObject(e,t,n){const{instanceRef:o,_events:s}=h(n),r=j(n,"point"),i=j(n,"locateOptions"),a=j(n,"options");return new Promise((n,c)=>{t.locate(r,i).done(r=>{if(r.length>0){const i=new t.Player(e,r[0],a);O(null,o,i),Object.keys(s).forEach(e=>m(i,e,s[e])),n(i)}},c)})}static updateObject(e,t,n){const{_events:o,instanceRef:s}=h(n),{_events:r,instanceRef:i}=h(t);if(b(n,"options")){const o=j(t,"options"),s=j(n,"options");o!==s&&e.options.set(s)}if(b(n,"point")){const o=j(n,"point"),s=j(t,"point"),r=j(n,"locateOptions");o!==s&&e.moveTo(o,r)}y(e,r,o),O(i,s,e)}static unmountObject(e,t){const{instanceRef:n,_events:o}=h(t);null!==e&&(Object.keys(o).forEach(t=>f(e,t,o[t])),O(n))}}E(c(C,!0,["panorama.isSupported","panorama.locate","panorama.createPlayer","panorama.Player"])).defaultProps={width:320,height:240};t.Component;t.Component;t.Component;class P extends t.Component{constructor(){super(),this.state={instance:null},this.instance=null}componentDidMount(){const{name:e,ymaps:t,dangerZone:n}=this.props,o=P.mountObject(n&&"function"==typeof n.modifyConstructor?n.modifyConstructor(t[e]):t[e],this.props);this.instance=o,this.setState({instance:o})}componentDidUpdate(e){null!==this.instance&&P.updateObject(this.instance,e,this.props)}componentWillUnmount(){P.unmountObject(this.instance,this.props)}render(){return null}static mountObject(e,t){const{instanceRef:n,parent:o,_events:s}=h(t),r=new e(j(t,"geometry"),j(t,"properties"),j(t,"options"));if(Object.keys(s).forEach(e=>m(r,e,s[e])),o&&o.geoObjects&&"function"==typeof o.geoObjects.add)o.geoObjects.add(r);else{if(!o||!o.add||"function"!=typeof o.add)throw new Error(`No parent found to mount ${t.name}`);o.add(r)}return O(null,n,r),r}static updateObject(e,t,n){const{_events:o,instanceRef:s}=h(n),{_events:r,instanceRef:i}=h(t);if(b(n,"geometry")){const o=j(t,"geometry",{}),s=j(n,"geometry",{});Array.isArray(s)&&s!==o?Array.isArray(s[0])&&"number"==typeof s[1]?(e.geometry.setCoordinates(s[0]),e.geometry.setRadius(s[1])):e.geometry.setCoordinates(s):"object"==typeof s&&(s.coordinates!==o.coordinates&&e.geometry.setCoordinates(s.coordinates),s.radius!==o.radius&&e.geometry.setRadius(s.radius))}if(b(n,"properties")){const o=j(t,"properties"),s=j(n,"properties");o!==s&&e.properties.set(s)}if(b(n,"options")){const o=j(t,"options"),s=j(n,"options");o!==s&&e.options.set(s)}y(e,r,o),O(i,s,e)}static unmountObject(e,t){const{instanceRef:n,parent:o,_events:s}=h(t);null!==e&&(Object.keys(s).forEach(t=>f(e,t,s[t])),o.geoObjects&&"function"==typeof o.geoObjects.remove?o.geoObjects.remove(e):o.remove&&"function"==typeof o.remove&&o.remove(e),O(n))}}var x,k=E((x=c(e=>t.createElement(P,n({},e,{name:"Placemark"})),!0,["Placemark"]),e=>t.createElement(r.Consumer,null,o=>t.createElement(x,n({parent:o},e)))));export{k as e,R as k,l as y};
